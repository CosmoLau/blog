import{_ as o,v as s,b as t,R as e}from"./chunks/framework.5ffcbaff.js";const a="/docs/cocos/assets/video.47d6197c.mp4",c="/docs/cocos/assets/document_image_rId19.a722b029.png",i="/docs/cocos/assets/document_image_rId20.bc330d0c.png",r="/docs/cocos/assets/document_image_rId21.de584638.png",l="/docs/cocos/assets/document_image_rId22.d305bf33.png",p="/docs/cocos/assets/document_image_rId23.53ec7ba3.png",n="/docs/cocos/assets/document_image_rId24.b084e170.png",d="/docs/cocos/assets/document_image_rId25.44348adc.png",m="/docs/cocos/assets/document_image_rId26.e5635900.png",_="/docs/cocos/assets/document_image_rId27.2a8e003c.png",g="/docs/cocos/assets/document_image_rId29.4c77b204.png",u="/docs/cocos/assets/document_image_rId30.3d4e903a.png",h="/docs/cocos/assets/document_image_rId31.2ca545b8.png",b="/docs/cocos/assets/document_image_rId32.94fb1428.png",I="/docs/cocos/assets/document_image_rId33.a43d16db.png",f="/docs/cocos/assets/document_image_rId34.2ac9e168.png",v="/docs/cocos/assets/document_image_rId35.9c420b48.png",D="/docs/cocos/assets/document_image_rId36.73686686.png",y="/docs/cocos/assets/document_image_rId37.2683629e.png",k="/docs/cocos/assets/document_image_rId38.88fb963b.png",E="/docs/cocos/assets/document_image_rId39.a6828b32.png",H="/docs/cocos/assets/document_image_rId40.4961e000.png",O="/docs/cocos/assets/document_image_rId41.f0ca155a.png",S="/docs/cocos/assets/document_image_rId42.2cffedbb.png",q="/docs/cocos/assets/document_image_rId43.3c233807.png",w="/docs/cocos/assets/document_image_rId44.a39de9fc.png",C="/docs/cocos/assets/document_image_rId45.0f85a516.png",K="/docs/cocos/assets/document_image_rId46.a8057e8b.png",A="/docs/cocos/assets/document_image_rId47.f89a9608.png",x="/docs/cocos/assets/document_image_rId11.ad09eebd.png",j="/docs/cocos/assets/document_image_rId14.390cabed.png",B="/docs/cocos/assets/document_image_rId15.4d4f29e9.png",P="/docs/cocos/assets/document_image_rId16.e25c42e0.png",z="/docs/cocos/assets/document_image_rId17.386d76d8.png",N="/docs/cocos/assets/document_image_rId18.2a3140d6.png",R="/docs/cocos/assets/document_image_rId8.325a5f3e.png",F="/docs/cocos/assets/document_image_rId7.11730900.png",M="/docs/cocos/assets/document_image_rId6.84f175c5.png",U="/docs/cocos/assets/document_image_rId5.5538c5a7.png",V="/docs/cocos/assets/document_image_rId10.9edc4022.png",T="/docs/cocos/assets/document_image_rId4.d603876d.png",L="/docs/cocos/assets/document_image_rId9.dffa6d2f.png",Y="/docs/cocos/assets/document_image_rId48.1551e61d.png",$="/docs/cocos/assets/document_image_rId49.77b241c2.png",J="/docs/cocos/assets/document_image_rId50.2fdf8373.png",G="/docs/cocos/assets/document_image_rId51.369cc0da.png",Q="/docs/cocos/assets/document_image_rId53.8aece976.png",W="/docs/cocos/assets/document_image_rId54.a6135ba5.png",X="/docs/cocos/assets/document_image_rId55.9294204a.png",Z="/docs/cocos/assets/document_image_rId56.7677c371.png",oo="/docs/cocos/assets/document_image_rId57.b8f59f7e.png",so="/docs/cocos/assets/document_image_rId58.f8179374.png",to="/docs/cocos/assets/document_image_rId59.52bc746b.png",eo="/docs/cocos/assets/document_image_rId60.8d188495.png",ao="/docs/cocos/assets/document_image_rId62.ea5da636.png",co="/docs/cocos/assets/document_image_rId64.94b8c361.png",io="/docs/cocos/assets/document_image_rId65.bf560edd.png",ro="/docs/cocos/assets/document_image_rId66.e3e52a10.png",lo="/docs/cocos/assets/document_image_rId67.f922956f.png",po="/docs/cocos/assets/document_image_rId68.4aa28988.png",no="/docs/cocos/assets/document_image_rId69.81d084ba.png",mo="/docs/cocos/assets/document_image_rId70.ac55e20c.png",_o="/docs/cocos/assets/document_image_rId71.38d97448.png",go="/docs/cocos/assets/document_image_rId72.4cfcedfd.png",Oo=JSON.parse('{"title":"发布到 OpenHarmony","description":"","frontmatter":{},"headers":[],"relativePath":"zh/manual/editor/publish/publish-openharmony.md","filePath":"zh/manual/editor/publish/publish-openharmony.md"}'),uo={name:"zh/manual/editor/publish/publish-openharmony.md"},ho=e('<h1 id="发布到-openharmony" tabindex="-1">发布到 OpenHarmony <a class="header-anchor" href="#发布到-openharmony" aria-label="Permalink to &quot;发布到 OpenHarmony&quot;">​</a></h1><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>我们在 Cocos Creator 3.6.1 的基础上成功适配了 OpenHarmony 在 7 月 30 日发布的 3.2 beta2 分支，并以《鹰击长空》项目为案例，成功运行在开发板上，并且能够相对流畅的操作。目前 OpenHarmony 平台的适配仍在持续进行中，因此需要单独下载社区版来试用，后续会进入到 Cocos Creator 的正式版本中。</p><p>鹰击长空：<a href="https://github.com/cocos/cocos-tutorial-airplane" target="_blank" rel="noreferrer">GitHub - cocos/cocos-tutorial-airplane: video tutorial airplane</a></p><p>游戏视频：</p><p><video src="'+a+'"></video></p><p>如无法观看视频，请点击 <a href="./publish-openharmony/video.mp4">下载地址</a> 下载后观看。</p><h2 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h2><ol><li><p>下载 Cocos Creator 3.6.1-OH 传送门：<a href="https://download.cocos.org/CocosCreator/voh/CocosCreator-v3.6.1-oh-win-092319.zip" target="_blank" rel="noreferrer">Cocos Creator 3.6.1-OH</a></p></li><li><p>下载 OpenHarmany系统，下载地址：</p></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">http://download.ci.openharmony.cn/version/Master_Version/OpenHarmony_3.2.5.5/20220926_081431/version-Master_Version-OpenHarmony_3.2.5.5-20220926_081431-dayu200.tar.gz</span></span></code></pre></div><ol start="3"><li>下载 OpenHarmony SDK系统，下载地址：</li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">http://download.ci.openharmony.cn/version/Master_Version/OpenHarmony_3.2.5.6/20220926_181435/version-Master_Version-OpenHarmony_3.2.5.6-20220926_181435-ohos-sdk-full.tar.gz</span></span></code></pre></div><ol start="4"><li><p>下载最新的IDE（版本&gt;=3.0.0.993）：<a href="https://developer.harmonyos.com/cn/develop/deveco-studio#download_beta_openharmony" target="_blank" rel="noreferrer">DevEco Studio</a></p></li><li><p>系统烧录工具：<a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">RKDevTool</a> 烧录工具与 <a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97#https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">使用文档</a></p></li><li><p>开发套件：<a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200" target="_blank" rel="noreferrer">HH-SCDAYU200</a></p></li></ol><h2 id="发布步骤" tabindex="-1">发布步骤 <a class="header-anchor" href="#发布步骤" aria-label="Permalink to &quot;发布步骤&quot;">​</a></h2><h3 id="系统烧录" tabindex="-1">系统烧录 <a class="header-anchor" href="#系统烧录" aria-label="Permalink to &quot;系统烧录&quot;">​</a></h3><ol><li>下载 <a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">windows平台工具</a>，解压后，如下图：</li></ol><p><img src="'+c+'" alt=""></p><ol start="2"><li>解压 DriverAssitant_v5.1.1，解压后，如下图：</li></ol><p><img src="'+i+'" alt=""></p><ol start="3"><li>双击 DriverInstall.exe 安装 USB 驱动，如下图</li></ol><p><img src="'+r+'" alt=""></p><ol start="4"><li>点击驱动安装，如下图：</li></ol><p><img src="'+l+'" alt=""></p><ol start="5"><li>连接设备，设备连接图，如下图：</li></ol><p><img src="'+p+'" alt=""></p><ol start="6"><li>切换根目录，双击 RKDevTool.exe，双击运行，如下图：</li></ol><p><img src="'+n+'" alt=""></p><ol start="7"><li>如果连上设备，默认就是&#39;发现一个MASKROM设备&#39;（必须安装 USB 驱动之后且连接设备后才会显示），如下图：</li></ol><p><img src="'+d+'" alt=""></p><ol start="8"><li><p>按着 recover（一直按着），然后按一下 reset 按钮（按一次，松开），过一会放开 recover，就会在 RKDevTool 工具里提示&#39;发现一个loader设备&#39;，如下图: <img src="'+m+'" alt=""></p></li><li><p>显示&#39;发现一个LOADER设备&#39;才能烧写系统，如下图：</p></li></ol><p><img src="'+_+'" alt=""></p><ol start="10"><li>出现这个状态之后，解压下载的 <a href="http://download.ci.openharmony.cn/version/Master_Version/OpenHarmony_3.2.5.5/20220926_081431/version-Master_Version-OpenHarmony_3.2.5.5-20220926_081431-dayu200.tar.gz" target="_blank" rel="noreferrer">OpenHarmony系统</a>，如下图：</li></ol><p><img src="'+g+'" alt=""></p><ol start="11"><li>在 RKDevTool软件中，把打勾的部分，选择解压的系统对应的文件，如下图</li></ol><p><img src="'+u+'" alt=""></p><ol start="12"><li>点击执行，等待日志显示&#39;下载完成&#39;即可。执行成功后，设备会自动进行重启，出现软件 OpenHarmony 界面欢迎页面，然后进入到桌面，即表示烧录成功，如下图：</li></ol><p><img src="'+h+'" alt=""></p><h3 id="安装-deveco-studio" tabindex="-1">安装 DevEco Studio <a class="header-anchor" href="#安装-deveco-studio" aria-label="Permalink to &quot;安装 DevEco Studio&quot;">​</a></h3><ol><li>下载最新的 IDE，下载对应平台的 IDE，点击右边的下载按钮，如下图：</li></ol><p><img src="'+b+'" alt=""></p><ol start="2"><li>解压目录，双击 deveco-studio-3.0.0.993.exe 进行安装，点击 next，如下图：</li></ol><p><img src="'+I+'" alt=""></p><ol start="3"><li>选择安装路径，点 next，如下图：</li></ol><p><img src="'+f+'" alt=""></p><ol start="4"><li>根据需求配置，点击 next，如下图:</li></ol><p><img src="'+v+'" alt=""></p><ol start="5"><li>点击安装，如下图：</li></ol><p><img src="'+D+'" alt=""></p><ol start="6"><li>等待安装，如下图：</li></ol><p><img src="'+y+'" alt=""></p><ol start="7"><li>安装完成，如下图：</li></ol><p><img src="'+k+'" alt=""></p><ol start="8"><li>启动DevEco Studio，如下图:</li></ol><p><img src="'+E+'" alt=""></p><ol start="9"><li>首次会提示设置源，默认应该就可以，如下图:</li></ol><p><img src="'+H+'" alt=""></p><ol start="10"><li>首次安装需要安装 Node.js，如果之前安装有 Node.js，选择本地的 Node.js 即可，但是有版本要求，Node.js 的版本必须大于 v14.19.1和小于 v15.0.0。npm 的版本要求大于 6.14.16 和小于 7.0.0。如下图：</li></ol><p><img src="'+O+'" alt=""></p><ol start="11"><li>这里选择下载新的 Node.js 为例，如下图:</li></ol><p><img src="'+S+'" alt=""></p><ol start="12"><li>等待下载完成，然后点击 Finish 按钮，如下图：</li></ol><p><img src="'+q+'" alt=""></p><ol start="13"><li>接下来会提示安装 SDK，点击下一步，注意是 OpenHarmonySDK，如下图</li></ol><p><img src="'+w+'" alt=""></p><ol start="14"><li>确认版本信息，点击 next，如下图：</li></ol><p><img src="'+C+'" alt=""></p><ol start="15"><li>选择 Accept 之后，选择 Next，如下图：</li></ol><p><img src="'+K+'" alt=""></p><ol start="16"><li>等待下载完成，之后点击 Finish 即可，如下图：</li></ol><p><img src="'+A+'" alt=""></p><h3 id="openharmonysdk-更换" tabindex="-1">OpenHarmonySDK 更换 <a class="header-anchor" href="#openharmonysdk-更换" aria-label="Permalink to &quot;OpenHarmonySDK 更换&quot;">​</a></h3><p>由于 SDK 随着 ID E的升级不断的升级，可能会导致部分兼容性的问题，为了能让工程正常运行，建议是替换 IDE 内置的 SDK。操作方法如下：</p><ol><li><p>更新 NDK</p><ul><li>找到下载的 OpenHarmony SDK，解压后，打开 ohos-sdk/windows，如下图：</li></ul><p><img src="'+x+'" alt=""></p><ul><li>找到 OpenHarmony 的 SDK\\nativ e目录（可以在 IDE 里查看目录），点开 <strong>IDE(DevEco)-&gt; 工具栏 File-&gt;Setting</strong> 即可, 如下图：</li></ul><p><img src="'+j+'" alt=""></p><ul><li>备份原来的 SDK 目录, 3.2.5.5_IDE 是备份目录，如下图：</li></ul><p><img src="'+B+'" alt=""></p><ul><li>解压 SDK，找到 ohos-sdk\\windows 里的 native-windows-3.2.5.6-Beta2.zip，解压至 OHOS_SDK/native 目录，重命名 native 文件夹（默认解压之后是 native 文件夹）为 3.2.5.5 的目录里，如下图：</li></ul><p><img src="'+P+'" alt=""></p><ul><li>修改 OHOS_SDK\\native\\3.2.5.5\\oh-uni-package.json （解压后的NDK），修改版本号为 3.2.5.5，这一步修改是为了避免提示 NDK 升级，如下图：</li></ul><p><img src="'+z+'" alt=""></p></li><li><p>更换 ets</p><ul><li>备份原来的 ets 文件，把目录下的 3.2.5.5（注意不同的IDE下载的版本不一样，例如 DEVECO 993里可能是 3.2.8.3，如果不是3.2.5.5则可以不需要备份，可以共存）改成 3.2.5.5_backup，如下图：</li></ul><p><img src="'+N+'" alt=""></p><ul><li>解压文件ets-windows-3.2.5.6-Beta2.zip至OHOS-SDK/ets目录：</li></ul><p><img src="'+R+'" alt=""></p><ul><li>解压至OHOS_SDK/ets目录，如下图：</li></ul><p><img src="'+F+'" alt=""></p><ul><li>把ets目录改成3.2.5.5，如下图：</li></ul><p><img src="'+M+'" alt=""></p><ul><li>修改 OHOS_SDK\\ets\\3.2.5.5\\oh-uni-package.json （解压后的ETS），修改版本号为 3.2.5.5。这一步修改是为了避免提示 ETS 升级，如下图：</li></ul><p><img src="'+U+'" alt=""></p><ul><li>打开命令行进入目录 OHOS_SDK\\ets\\3.2.5.5\\build-tools\\ets-loader，并执行 <code>npm install</code>，如下图（注意目录要匹配）：</li></ul><p><img src="'+V+'" alt=""></p><blockquote><p><strong>注意</strong>：如果 <code>npm install</code> 报错，检查下是否配置了华为的源，配置方法如下：</p><p><code>npm config set registry https://repo.huaweicloud.com/repository/npm/</code></p></blockquote><ul><li>在 deveco 里，clear project 之后，重新 build 即可。clear project 操作如下图：</li></ul><p><img src="'+T+'" alt=""></p></li><li><p>其他 将 js-windows-3.2.5.6-Beta2.zip、previewer-windows-3.2.5.6-Beta2.zip、toolchains-windows-3.2.5.6-Beta2.zip 这三个文件参考上述步骤替换，总结步骤入下：</p><ul><li>备份源目录文件；</li><li>解压，重命名对应版本文件；</li><li>修改对应目录的oh-uni-package.json文件;</li></ul><p>目录对应关系，如下图：</p><p><img src="'+L+'" alt=""></p></li></ol><h3 id="cocos-creator-3-6-1-oh-构建-openharmony-工程" tabindex="-1">Cocos Creator 3.6.1-OH 构建 OpenHarmony 工程 <a class="header-anchor" href="#cocos-creator-3-6-1-oh-构建-openharmony-工程" aria-label="Permalink to &quot;Cocos Creator 3.6.1-OH 构建 OpenHarmony 工程&quot;">​</a></h3><ol><li>设置 OpenHarmony SDK 的路径，如下图：</li></ol><p><img src="'+Y+'" alt=""></p><p>可以使用 DevEco 查看 SDK 的路径。</p><ol start="2"><li>打开 DevEco，点击标题栏里的，File-&gt;Settings...，如下图：</li></ol><p><img src="'+$+'" alt=""></p><ol start="3"><li>查看 OpenHarmony SDK 的配置，如下图：</li></ol><p><img src="'+J+'" alt=""></p><blockquote><p><strong>注意</strong>：API Version 9 的版本要为已安装的状态，如果未安装，需要手动安装，如上图所示。</p></blockquote><ol start="2"><li>打开 Cocos Creator，打开存在的项目，如下图：</li></ol><blockquote><p><img src="'+G+'" alt=""></p></blockquote><ol start="3"><li>选择工程的目录，以下以 <a href="https://github.com/cocos/cocos-test-projects/tree/v3.7" target="_blank" rel="noreferrer">cocos-test-projects</a> 为例，如下图：</li></ol><p><img src="'+Q+'" alt=""></p><ol start="4"><li>登录开发者账号，如下图：</li></ol><p><img src="'+W+'" alt=""></p><ol start="5"><li><p>根据创建游戏，增加游戏逻辑等</p></li><li><p>制作完成之后，选择构建，选择标题栏中的 Project-&gt;Build，也可以使用 Ctrl+Shift+B 的快捷键，如下图：</p></li></ol><p><img src="'+X+'" alt=""></p><ol start="7"><li>点击新建任务，如下图：</li></ol><p><img src="'+Z+'" alt=""></p><ol start="8"><li>选择 Openharmony</li></ol><p><img src="'+oo+'" alt=""></p><ol start="9"><li>配置工程名称、配置开始场景与包含的其他场景，勾选调试模式（其他参数需要保持默认配置），点击 build，如下图：</li></ol><p><img src="'+so+'" alt=""></p><p>11、点击 make（目前会提示失败，但是会生成无签名的 hap 包），之后点击 run（需要设备，由于没有签名，目前 run 会失败）即可（由于目前 make 和 run 都会失败，因此可以不操作）。</p><p><img src="'+to+'" alt=""></p><h3 id="烧录-hap-包到-rk-板" tabindex="-1">烧录 Hap 包到 RK 板 <a class="header-anchor" href="#烧录-hap-包到-rk-板" aria-label="Permalink to &quot;烧录 Hap 包到 RK 板&quot;">​</a></h3><ol><li>构建工程成功后，如下状态即可，make 与 run 可以不需要点击，如下图：</li></ol><p><img src="'+eo+'" alt=""></p><ol start="2"><li>使用<a href="https://developer.harmonyos.com/cn/develop/deveco-studio#download" target="_blank" rel="noreferrer">DevEcoStudio</a>，打开工程，如下图：</li></ol><p><img src="'+ao+'" alt=""></p><ol start="3"><li>找到工程目录（native/engine/openharmony）并点击打开，如下图（下图是以<a href="https://github.com/cocos/cocos-test-projects" target="_blank" rel="noreferrer">cocos-test-projects</a>为例）：</li></ol><p><img src="'+co+'" alt=""></p><ol start="4"><li>配置签名，如下图：</li></ol><p><img src="'+io+'" alt=""></p><ol start="5"><li>插入设备，点击运行，如下图：</li></ol><p><img src="'+ro+'" alt=""></p><p>执行成功之后，就能看到效果了。</p><h2 id="几个注意事项" tabindex="-1">几个注意事项 <a class="header-anchor" href="#几个注意事项" aria-label="Permalink to &quot;几个注意事项&quot;">​</a></h2><p>目前适配的是 OpenHarmony 32 位系统，且系统暂不支持 JIT，因此性能会比较受限。引擎会继续适配 64 位系统，并继续优化性能。</p><p>另外，因为 OpenHarmony 还在不断完善当中，因此有些已知问题。这些问题都会在后续的版本解决。这些已知问题是：</p><ol><li><p>未适配功能</p><ul><li><p>videoplay</p></li><li><p>webview</p></li><li><p>editbox 输入法</p></li><li><p>network 网络相关的模块</p></li><li><p>重力传感器模块</p></li><li><p>横屏、竖屏适配接口</p></li></ul></li><li><p>已知效果问题</p><ul><li><p>restart 还有问题；</p></li><li><p>音频播放带有杂音，播放速度比较慢；（单通道和 OpenSELS 的问题）</p></li><li><p>部分测试例，背景会显示桌面</p></li><li><p>用到 top level await 的代码，例如 L10N 暂时无法适配；</p></li><li><p>手动关闭 L10N</p><blockquote><blockquote><p>由于 OpenHarmony 的 bata3.2 的分支目前支持 async 有问题，导致 L10N 的组件使用不了，需要手动关闭。</p><p>（1）打工具栏，Pannel-&gt;localization Editor 选项，如下图：</p><p><img src="'+lo+'" alt=""></p><p>（2）点击右上角三个点的按钮，选择关闭 L10N，如下图：</p><p><img src="'+po+'" alt=""></p><p>如果是已关闭状态，则不需要关闭。关闭状态如下图：</p><p><img src="'+no+'" alt=""></p><p>（3）如果测试的是 cocos-test-project 工程，选择 Assets-&gt;cases-&gt;localization-deitor-&gt;点击鼠标右键-&gt;选择删除。</p><p><img src="'+mo+'" alt=""></p></blockquote></blockquote></li><li><p>如果修改 build 工程的参数，重新 build 之后，需要在 IDE 里，清楚缓存之后在编译，否则有可能会出现不生效的情况。这是 DevEco Studio 本身的问题，目前正在解决。操作如下图：</p><blockquote><blockquote><p><img src="'+_o+'" alt=""></p><p>如果修改工程里的 js 文件等，也同样需要 clean project 的操作。否则也可能会不生效。</p></blockquote></blockquote></li><li><p>编译失败时，可以退出部分应用，重新 build 试试；</p><blockquote><blockquote><p><img src="'+go+'" alt=""></p></blockquote></blockquote></li></ul></li></ol>',114),bo=[ho];function Io(fo,vo,Do,yo,ko,Eo){return s(),t("div",null,bo)}const So=o(uo,[["render",Io]]);export{Oo as __pageData,So as default};
