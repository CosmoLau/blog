import{_ as e,c as s,o,a5 as t}from"./chunks/framework.CqnjdYks.js";const a="/docs/cocos/assets/subpackage-config.Bl-57qhW.png",n="/docs/cocos/assets/subpackage.C0ytSBU-.png",r="/docs/cocos/assets/profile.C0Y7R7tZ.png",i="/docs/cocos/assets/devtools-setting.DInupnUI.png",c="/docs/cocos/assets/vivo-profile.DPeNKKDC.png",l="/docs/cocos/assets/vivo-subpackages.Xwty4V3t.png",q=JSON.parse('{"title":"小游戏分包","description":"","frontmatter":{},"headers":[],"relativePath":"zh/manual/editor/publish/subpackage.md","filePath":"zh/manual/editor/publish/subpackage.md"}'),p={name:"zh/manual/editor/publish/subpackage.md"},d=t('<h1 id="小游戏分包" tabindex="-1">小游戏分包 <a class="header-anchor" href="#小游戏分包" aria-label="Permalink to &quot;小游戏分包&quot;">​</a></h1><p>部分小游戏平台支持分包功能以便对资源、脚本和场景进行划分，包括微信小游戏、百度小游戏、小米快游戏、字节跳动小游戏、华为快游戏、OPPO 小游戏和 vivo 小游戏。</p><p>Cocos Creator 从 v2.4 开始支持 <a href="./../../asset/bundle.html">Asset Bundle</a>，开发者可以将需要分包的内容划分成多个 Asset Bundle，这些 Asset Bundle 会被构建成小游戏的分包。在启动游戏时只会下载必要的主包，不会加载这些分包，而是由开发者在游戏过程中手动加载分包，从而有效降低游戏启动的时间。</p><h2 id="配置方法" tabindex="-1">配置方法 <a class="header-anchor" href="#配置方法" aria-label="Permalink to &quot;配置方法&quot;">​</a></h2><p>Asset Bundle 是以 <strong>文件夹</strong> 为单位进行配置的。当我们在 <strong>资源管理器</strong> 中选中一个文件夹时，<strong>属性检查器</strong> 中就会出现一个 <strong>配置为 Bundle</strong> 的选项，勾选后会出现如下图的配置项：</p><p><img src="'+a+'" alt="subpackage configuration"></p><p>除了通用的 <a href="./../../asset/bundle.html#配置方法">Asset Bundle 配置</a> 之外，小游戏分包主要需要关注的设置包括：</p><ul><li>将 <strong>目标平台</strong> 设置成需要分包的小游戏平台，<strong>压缩类型</strong> 设置为 <strong>小游戏分包</strong>。</li><li>小游戏分包只能放在本地，不能配置为远程包，所以 <strong>配置为远程包</strong> 项为锁住状态，不可勾选。</li></ul><p>配置完成后点击右上方的 <strong>打勾</strong> 按钮，这个文件夹就被配置成 Asset Bundle 了。</p><h2 id="构建" tabindex="-1">构建 <a class="header-anchor" href="#构建" aria-label="Permalink to &quot;构建&quot;">​</a></h2><p>在构建时，需要将 <strong>构建发布</strong> 面板中的 <strong>主包压缩类型</strong> 设置为 <strong>小游戏分包</strong>。具体说明可参考文档 <a href="./../../asset/bundle.html#压缩类型">Asset Bundle — 压缩类型</a>。</p><p>项目构建完成后，这个 Asset Bundle 文件夹会被打包到小游戏平台发布包目录下的 <strong>subpackages</strong> 文件夹中。该文件夹中包含的每个文件夹都是一个 Asset Bundle。</p><p>例如：将 Hello World 工程中的 <code>assets/scene</code> 文件夹在微信小游戏平台配置为 Asset Bundle，那么项目构建后将会在微信小游戏发布包目录下生成 <code>subpackages/scene</code> 文件夹。<code>scene</code> 文件夹就是一个 Asset Bundle。</p><p><img src="'+n+'" alt="subpackage"></p><h2 id="微信小游戏" tabindex="-1">微信小游戏 <a class="header-anchor" href="#微信小游戏" aria-label="Permalink to &quot;微信小游戏&quot;">​</a></h2><p>在微信小游戏的构建中，Asset Bundle 的配置也会按照规则自动生成到微信小游戏发布包目录下的 <code>game.json</code> 配置文件中。</p><p><img src="'+r+'" alt="profile"></p><blockquote><p><strong>注意</strong>：微信小游戏需要特定的版本才能支持分包功能。微信 6.6.7 客户端，2.1.0 及以上基础库开始支持，请更新至最新客户端版本，开发者工具请使用 1.02.1806120 及以上版本。更新了开发者工具后不要忘记修改开发者工具中的 <strong>详情 -&gt; 本地设置 -&gt; 调试基础库</strong> 为 2.1.0 及以上：</p><p><img src="'+i+'" alt="devtools setting"></p></blockquote><h3 id="分包加载包大小的限制" tabindex="-1">分包加载包大小的限制 <a class="header-anchor" href="#分包加载包大小的限制" aria-label="Permalink to &quot;分包加载包大小的限制&quot;">​</a></h3><p>目前微信小游戏分包大小有以下限制：</p><ul><li>整个微信小游戏所有分包大小不超过 <strong>20M</strong></li><li>单个分包不限制大小</li><li>主包大小不能超过 <strong>4M</strong></li></ul><p>具体请参考 <a href="https://developers.weixin.qq.com/minigame/dev/guide/base-ability/sub-packages.html" target="_blank" rel="noreferrer">微信小游戏分包加载官方文档</a>。</p><h2 id="vivo-小游戏" tabindex="-1">vivo 小游戏 <a class="header-anchor" href="#vivo-小游戏" aria-label="Permalink to &quot;vivo 小游戏&quot;">​</a></h2><p>在 vivo 小游戏的构建中，Asset Bundle 的配置也会按照规则自动生成到 vivo 小游戏发布包 <code>vivo-mini-game/src</code> 目录下的 <code>manifest.json</code> 配置文件中。以配置 <code>scene</code> 文件夹为例：</p><p><img src="'+c+'" alt="profile"></p><blockquote><p><strong>注意</strong>：</p><ol><li><p><strong>快应用 &amp; vivo 小游戏调试器</strong> 从 <strong>1051</strong> 版本开始支持 vivo 小游戏分包加载。低于 1051 的版本虽然不支持分包加载，但是也做了兼容处理，如果使用了分包也不会影响游戏正常运行。具体可参考 <a href="https://minigame.vivo.com.cn/documents/#/lesson/base/subpackage?id=%e8%bf%90%e8%a1%8c%e6%97%b6%e5%85%bc%e5%ae%b9" target="_blank" rel="noreferrer">vivo 分包加载-运行时兼容</a>。</p></li><li><p>与其他小游戏平台不同的是，项目构建后 vivo 小游戏的 Asset Bundle 文件夹是生成在发布包 <code>vivo-mini-game</code> 目录下的 <code>src</code> 目录。</p><p><img src="'+l+'" alt=""></p></li></ol></blockquote><h3 id="分包加载包的限制" tabindex="-1">分包加载包的限制 <a class="header-anchor" href="#分包加载包的限制" aria-label="Permalink to &quot;分包加载包的限制&quot;">​</a></h3><p>目前 vivo 小游戏分包大小限制为 20M（主包限制 4M 及分包大小限制 16M）。</p><p>具体请参考 <a href="https://minigame.vivo.com.cn/documents/#/lesson/base/subpackage" target="_blank" rel="noreferrer">vivo 小游戏官方文档 — 分包加载</a>。</p>',29),g=[d];function u(h,m,b,v,_,f){return o(),s("div",null,g)}const B=e(p,[["render",u]]);export{q as __pageData,B as default};
