import{_ as s,c as i,o as e,a4 as a}from"./chunks/framework.uQk9_EO2.js";const t="/docs/cocos/assets/extension-database.2qQRwCpN.png",u=JSON.parse('{"title":"Extending the Database (DB)","description":"","frontmatter":{},"headers":[],"relativePath":"en/editor/extension/contributions-database.md","filePath":"en/editor/extension/contributions-database.md","lastUpdated":1712305443000}'),n={name:"en/editor/extension/contributions-database.md"},o=a(`<h1 id="extending-the-database-db" tabindex="-1">Extending the Database (DB) <a class="header-anchor" href="#extending-the-database-db" aria-label="Permalink to &quot;Extending the Database (DB)&quot;">​</a></h1><p>All asset files in the project are managed through the asset database, where the <code>assets</code> directory in the project stores the assets of the current project, and the <code>editor/assets</code> in the engine repository stores the built-in assets of the engine (e.g., common images, scripts, etc.).</p><p>When we use the assets in the extension, we need to register the asset folder in the extension to the asset database, and publish the assets with the extension when it is released.</p><p>Through this article we will learn how to register a asset folder and use the assets in scripts.</p><h2 id="registration-database-configuration" tabindex="-1">Registration Database Configuration <a class="header-anchor" href="#registration-database-configuration" aria-label="Permalink to &quot;Registration Database Configuration&quot;">​</a></h2><p>Asset registration needs to be configured in <code>contributions</code> using the <code>asset-db</code> field, as follows.</p><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test-package&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;contributions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;asset-db&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;mount&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./assets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &quot;readonly&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>In the above example, we have registered the <code>assets</code> folder in the root directory of the extension <code>test-package</code> to the asset database.</p><h2 id="writing-script-resources-in-extensions" tabindex="-1">Writing Script Resources in Extensions <a class="header-anchor" href="#writing-script-resources-in-extensions" aria-label="Permalink to &quot;Writing Script Resources in Extensions&quot;">​</a></h2><p>Create a script <code>foo.ts</code> in the <code>test-package/assets/</code> directory, with the following content：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/// foo.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { _decorator, Component, Node } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;cc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ccclass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _decorator;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ccclass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Foo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>In order to use the <code>cc</code> definitions, we need to copy the definition files from <code>{project directory}\\temp\\declarations</code> to the extension root directory.</p><p>Since <code>foo.ts</code> is only used as a asset and is not part of the extension source code, we need to exclude it by adding <code>exclude</code> configuration to <code>tsconfig.json</code>, otherwise we will get a compilation error.</p><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;compilerOptions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;exclude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./assets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p><strong>Note</strong>: The script assets in the extension can be written and tested in the Cocos Creator project and then copied to the extension&#39;s <code>assets</code> directory.</p></blockquote><h2 id="other-assets" tabindex="-1">Other Assets <a class="header-anchor" href="#other-assets" aria-label="Permalink to &quot;Other Assets&quot;">​</a></h2><p>Assets such as images, text, fonts, etc. can be placed directly in the <code>assets</code> directory.</p><h2 id="using-assets-in-extensions" tabindex="-1">Using Assets in Extensions <a class="header-anchor" href="#using-assets-in-extensions" aria-label="Permalink to &quot;Using Assets in Extensions&quot;">​</a></h2><p>Refresh the extension and you will see a new <code>test-package</code> assets package in the <strong>Assets Manager</strong> panel of the Cocos Creator editor, as shown below:s</p><p><img src="`+t+`" alt="extension-database"></p><h2 id="drag-and-drop-assets" tabindex="-1">Drag-and-drop Assets <a class="header-anchor" href="#drag-and-drop-assets" aria-label="Permalink to &quot;Drag-and-drop Assets&quot;">​</a></h2><p>To reference an asset within a package as a drag-and-drop component, use it in the same way as the assets in <code>assets</code> and <code>internal</code>.</p><h2 id="import-script" tabindex="-1">Import Script <a class="header-anchor" href="#import-script" aria-label="Permalink to &quot;Import Script&quot;">​</a></h2><p>You can simply reference a script file from the AssetDatabase as follows:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/// bar.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Foo } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;db://test-package/foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>You don&#39;t need to pay attention to whether a class comes from an extension package, the TypeScript development environment&#39;s auto-completion feature will prompt the <strong>import</strong> directory, no need to worry.</p><blockquote><p><strong>Note</strong>: The class name in the extension package should be kept globally unique, otherwise it will cause conflicts, try to add a suitable prefix in the actual development (e.g. <code>test-package</code> can be shortened to <code>TP</code>, and all classes in the package are unified with the <code>TP</code> prefix to become <code>TPFoo</code>).</p></blockquote>`,27),h=[o];function p(l,r,d,k,c,E){return e(),i("div",null,h)}const y=s(n,[["render",p]]);export{u as __pageData,y as default};
