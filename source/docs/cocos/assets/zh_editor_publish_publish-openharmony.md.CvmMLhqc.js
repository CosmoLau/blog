import{_ as s,c as e,o as t,a4 as c}from"./chunks/framework.uQk9_EO2.js";const a="/docs/cocos/assets/video.vS-fR6JI.mp4",r="/docs/cocos/assets/document_image_rId2.DeseK7a_.png",p="/docs/cocos/assets/document_image_rId0.6evLxkQY.png",o="/docs/cocos/assets/document_image_rId3.CZc5Ey7C.png",i="/docs/cocos/assets/document_image_rId19.CD_eSDU0.png",n="/docs/cocos/assets/document_image_rId20.xUa4wb0y.png",l="/docs/cocos/assets/document_image_rId21.pmpW_Ff_.png",m="/docs/cocos/assets/document_image_rId22.CxMkDlOJ.png",d="/docs/cocos/assets/document_image_rId23.lJ8UoqcZ.png",_="/docs/cocos/assets/document_image_rId24.PUxQsd6S.png",g="/docs/cocos/assets/document_image_rId25.DpI5o-Ps.png",h="/docs/cocos/assets/document_image_rId26.D_d6TE4D.png",u="/docs/cocos/assets/document_image_rId27.Bh985MXj.png",b="/docs/cocos/assets/document_image_rId29.CIqVX3tI.png",I="/docs/cocos/assets/document_image_rId29-1.DZKKIHk4.png",D="/docs/cocos/assets/document_image_rId29-2.ChnHVzBr.png",y="/docs/cocos/assets/document_image_rId30-1.CdIo-qbV.png",f="/docs/cocos/assets/document_image_rId30.BEo7m68O.png",k="/docs/cocos/assets/document_image_rId31.DctHqEfF.png",v="/docs/cocos/assets/document_image_rId33.CXwLyLxz.png",E="/docs/cocos/assets/document_image_rId34.ifcaYEKO.png",H="/docs/cocos/assets/document_image_rId35.BLh37zNe.png",O="/docs/cocos/assets/document_image_rId36.Byv5qIQs.png",S="/docs/cocos/assets/document_image_rId37.BpALUTie.png",x="/docs/cocos/assets/document_image_rId38.CWebAMnE.png",C="/docs/cocos/assets/document_image_rId39.D47nOayP.png",q="/docs/cocos/assets/document_image_rId40.BUS2hzz2.png",B="/docs/cocos/assets/document_image_rId41.ChUCvYxj.png",w="/docs/cocos/assets/document_image_rId42._uNRPw1e.png",K="/docs/cocos/assets/document_image_rId43.B9PnyEfq.png",A="/docs/cocos/assets/document_image_rId44.Dpi33b7B.png",P="/docs/cocos/assets/document_image_rId45.BasOyXJY.png",U="/docs/cocos/assets/document_image_rId46.BwTtDQ_f.png",R="/docs/cocos/assets/document_image_rId47.D6lFgrME.png",F="/docs/cocos/assets/document_image_rId11.0rzlBBvh.png",z="/docs/cocos/assets/document_image_rId14.Bpg-CIca.png",j="/docs/cocos/assets/document_image_rId18.Dq02C8KK.png",T="/docs/cocos/assets/document_image_rId8.D5f4XZQw.png",N="/docs/cocos/assets/document_image_rId10.CJUGFyU6.png",L="/docs/cocos/assets/document_image_rId4.Bom1HGP3.png",Y="/docs/cocos/assets/document_image_rId9.DBilbIf9.png",G="/docs/cocos/assets/document_image_rId48.BoFtrriO.png",M="/docs/cocos/assets/document_image_rId49.BDoHfw8S.png",J="/docs/cocos/assets/document_image_rId50.CUvt7W_r.png",V="/docs/cocos/assets/document_image_rId51.Bm59N3X5.png",Q="/docs/cocos/assets/document_image_rId53.BLRAjdU6.png",X="/docs/cocos/assets/document_image_rId54.GCuN1oZ-.png",Z="/docs/cocos/assets/document_image_rId55.BkFLFYNr.png",W="/docs/cocos/assets/document_image_rId56.Do-M1GTF.png",$="/docs/cocos/assets/document_image_rId57.Uwr_GRhl.png",oo="/docs/cocos/assets/document_image_rId58.Dgzk7oJZ.png",so="/docs/cocos/assets/document_image_rId58-1.CE-2pxsW.png",eo="/docs/cocos/assets/document_image_rId59.fmLwUkg7.png",to="/docs/cocos/assets/document_image_rId60.B0d-8Jyx.png",co="/docs/cocos/assets/document_image_rId62.B-L_o6l-.png",ao="/docs/cocos/assets/document_image_rId64.BI-TUjc6.png",ro="/docs/cocos/assets/document_image_rId65.QQgmFbGF.png",po="/docs/cocos/assets/document_image_rId66.BgGh6Mmc.png",io="/docs/cocos/assets/document_image_rId72.pQtCzBnt.png",no="/docs/cocos/assets/document_image_rId73.C4-DUnS_.png",lo="/docs/cocos/assets/document_image_rId74.DFe9wgou.png",mo="/docs/cocos/assets/document_image_rId75.UGIxk-G0.png",Eo=JSON.parse('{"title":"发布到 OpenHarmony","description":"","frontmatter":{},"headers":[],"relativePath":"zh/editor/publish/publish-openharmony.md","filePath":"zh/editor/publish/publish-openharmony.md","lastUpdated":1712305443000}'),_o={name:"zh/editor/publish/publish-openharmony.md"},go=c('<h1 id="发布到-openharmony" tabindex="-1">发布到 OpenHarmony <a class="header-anchor" href="#发布到-openharmony" aria-label="Permalink to &quot;发布到 OpenHarmony&quot;">​</a></h1><p>自 Cocos Creator v3.8 起，支持发布到 OpenHarmony 平台。</p><h2 id="支持情况" tabindex="-1">支持情况 <a class="header-anchor" href="#支持情况" aria-label="Permalink to &quot;支持情况&quot;">​</a></h2><table><thead><tr><th style="text-align:left;">引擎版本</th><th style="text-align:left;">OpenHarmony 版本</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">v3.6.1 ~ v3.7.3</td><td style="text-align:left;">OpenHarmony 3.2 beta</td><td style="text-align:left;">该版本在社区公测，因此无法从 Dashboard 直接下载，开发者请从 <a href="https://forum.cocos.org/t/topic/141299" target="_blank" rel="noreferrer">社区下载</a></td></tr><tr><td style="text-align:left;">v3.8</td><td style="text-align:left;">OpenHarmony 3.2，OpenHarmony 4.0</td><td style="text-align:left;">正式版，开发者可以选择从 Dashboard 中直接下载该编辑器版本。</td></tr></tbody></table><p>如果您使用的引擎版本低于 v3.8，我们建议您升级到 v3.8 方便发布正式版。</p><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>我们在 Cocos Creator v3.8.0 的基础上成功适配了在 2023 年 4 月 9 日发布的 <a href="https://gitee.com/openharmony/docs/blob/master/zh-cn/release-notes/OpenHarmony-v3.2-release.md" target="_blank" rel="noreferrer">OpenHarmony 3.2 Release</a> 分支。</p><p>鹰击长空：<a href="https://github.com/cocos/cocos-tutorial-airplane" target="_blank" rel="noreferrer">GitHub - cocos/cocos-tutorial-airplane: video tutorial airplane</a></p><p>游戏视频：</p><p><video src="'+a+'"></video></p><p>如无法观看视频，请点击 <a href="./publish-openharmony/video.mp4">下载地址</a> 下载后观看。</p><h2 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h2><ol><li><p>Cocos Creator 下载传送门（版本&gt;=3.8.0）：<a href="https://www.cocos.com/creator-download" target="_blank" rel="noreferrer">Cocos Creator</a></p></li><li><p>OpenHarmany 系统与 SDK 下载传送门：<a href="https://gitee.com/openharmony/docs/blob/master/zh-cn/release-notes/OpenHarmony-v3.2-release.md#%E4%BB%8E%E9%95%9C%E5%83%8F%E7%AB%99%E7%82%B9%E8%8E%B7%E5%8F%96" target="_blank" rel="noreferrer">OpenHarmony-3.2-release</a></p><p><img src="'+r+'" alt=""></p></li></ol><p>OpenHarmony 发布的系统是 <strong>32位</strong> 的，<strong>64位</strong> 下载传送门：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://ci.openharmony.cn/workbench/cicd/dailybuild/dailylist</span></span></code></pre></div><p><img src="'+p+'" alt=""></p><ol start="3"><li><p>下载最新的 IDE（版本&gt;=3.1.1）：<a href="https://developer.harmonyos.com/cn/develop/deveco-studio#download" target="_blank" rel="noreferrer">DevEco Studio</a></p><p><img src="'+o+'" alt=""></p></li><li><p>系统烧录工具：<a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">RKDevTool</a> 烧录工具与 <a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97#https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">使用文档</a></p></li><li><p>开发套件：<a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200" target="_blank" rel="noreferrer">HH-SCDAYU200</a></p></li></ol><h2 id="发布步骤" tabindex="-1">发布步骤 <a class="header-anchor" href="#发布步骤" aria-label="Permalink to &quot;发布步骤&quot;">​</a></h2><h3 id="系统烧录" tabindex="-1">系统烧录 <a class="header-anchor" href="#系统烧录" aria-label="Permalink to &quot;系统烧录&quot;">​</a></h3><ol><li><p>下载 <a href="https://gitee.com/hihope_iot/docs/tree/master/HiHope_DAYU200/%E7%83%A7%E5%86%99%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8C%87%E5%8D%97/windows" target="_blank" rel="noreferrer">windows平台工具</a>，解压后，如下图：</p><p><img src="'+i+'" alt=""></p></li><li><p>解压 DriverAssitant_v5.1.1，解压后，如下图：</p><p><img src="'+n+'" alt=""></p></li><li><p>双击 DriverInstall.exe 安装 USB 驱动，如下图</p><p><img src="'+l+'" alt=""></p></li><li><p>点击驱动安装，如下图：</p><p><img src="'+m+'" alt=""></p></li><li><p>连接设备，设备连接图，如下图：</p><p><img src="'+d+'" alt=""></p></li><li><p>切换根目录，双击 RKDevTool.exe，双击运行，如下图：</p><p><img src="'+_+'" alt=""></p></li><li><p>如果连上设备，默认就是&#39;发现一个MASKROM设备&#39;（必须安装 USB 驱动之后且连接设备后才会显示），如下图：</p><p><img src="'+g+'" alt=""></p></li><li><p>按着 recover（一直按着），然后按一下 reset 按钮（按一次，松开），过一会放开 recover，就会在 RKDevTool 工具里提示&#39;发现一个loader设备&#39;，如下图: <img src="'+h+'" alt=""></p></li><li><p>显示&#39;发现一个LOADER设备&#39;才能烧写系统，如下图：</p><p><img src="'+u+'" alt=""></p></li><li><p>出现这个状态之后，解压下载的 <a href="http://download.ci.openharmony.cn/version/Master_Version/OpenHarmony_3.2.5.5/20220926_081431/version-Master_Version-OpenHarmony_3.2.5.5-20220926_081431-dayu200.tar.gz" target="_blank" rel="noreferrer">OpenHarmony系统</a>。解压后，如下图：</p><p><img src="'+b+'" alt=""></p></li><li><p>鼠标右键，选择导入配置，如下图：</p><p><img src="'+I+'" alt=""></p></li><li><p>选择解压后的系统文件中的config.cfg分区配置文件，如下图：</p><p><img src="'+D+'" alt=""></p></li><li><p>在 RKDevTool软件中，把打勾的部分，选择解压的系统对应的文件，如下图：</p><p><img src="'+y+'" alt=""></p><p><img src="'+f+'" alt=""></p></li><li><p>点击执行，等待日志显示&#39;下载完成&#39;即可。执行成功后，设备会自动进行重启，出现软件 OpenHarmony 界面欢迎页面，然后进入到桌面，即表示烧录成功，如下图：</p></li></ol><p><img src="'+k+'" alt=""></p><h3 id="安装-deveco-studio" tabindex="-1">安装 DevEco Studio <a class="header-anchor" href="#安装-deveco-studio" aria-label="Permalink to &quot;安装 DevEco Studio&quot;">​</a></h3><ol><li><p>下载最新的 IDE，下载对应平台的 IDE，点击右边的下载按钮，如下图：</p><p><img src="'+o+'" alt=""></p></li><li><p>解压目录，双击 deveco-studio-3.0.0.993.exe 进行安装，点击 next，如下图：</p><p><img src="'+v+'" alt=""></p></li><li><p>选择安装路径，点 next，如下图：</p><p><img src="'+E+'" alt=""></p></li><li><p>根据需求配置，点击 next，如下图:</p><p><img src="'+H+'" alt=""></p></li><li><p>点击安装，如下图：</p><p><img src="'+O+'" alt=""></p></li><li><p>等待安装，如下图：</p><p><img src="'+S+'" alt=""></p></li><li><p>安装完成，如下图：</p><p><img src="'+x+'" alt=""></p></li><li><p>启动DevEco Studio，如下图:</p><p><img src="'+C+'" alt=""></p></li><li><p>首次会提示设置源，默认应该就可以，如下图:</p><p><img src="'+q+'" alt=""></p></li><li><p>首次安装需要安装 Node.js，如果之前安装有 Node.js，选择本地的 Node.js 即可，但是有版本要求，Node.js 的版本必须大于 v14.19.1和小于 v15.0.0。npm 的版本要求大于 6.14.16 和小于 7.0.0。如下图：</p><p><img src="'+B+'" alt=""></p></li><li><p>这里选择下载新的 Node.js 为例，如下图:</p><p><img src="'+w+'" alt=""></p></li><li><p>等待下载完成，然后点击 Finish 按钮，如下图：</p><p><img src="'+K+'" alt=""></p></li><li><p>接下来会提示安装 SDK，点击下一步，注意是 OpenHarmonySDK，如下图</p><p><img src="'+A+'" alt=""></p></li><li><p>确认版本信息，点击 next，如下图：</p><p><img src="'+P+'" alt=""></p></li><li><p>选择 Accept 之后，选择 Next，如下图：</p><p><img src="'+U+'" alt=""></p></li><li><p>等待下载完成，之后点击 Finish 即可，如下图：</p><p><img src="'+R+'" alt=""></p></li></ol><h3 id="openharmonysdk-更换" tabindex="-1">OpenHarmonySDK 更换 <a class="header-anchor" href="#openharmonysdk-更换" aria-label="Permalink to &quot;OpenHarmonySDK 更换&quot;">​</a></h3><p>由于 SDK 随着 IDE的升级不断的升级，可能会导致部分兼容性的问题，为了能让工程正常运行，建议是替换 IDE 内置的 SDK。操作方法如下：</p><ol><li>更新 NDK</li></ol><ul><li><p>备份原来的SDK目录, native_backup是备份原来为native目录，如下图：</p><p><img src="'+F+'" alt=""></p></li><li><p>解压SDK，找到ohos-sdk\\windows里的native-windows-x64-3.2.11.9-Release.zip，解压至OHOS_SDK/9目录，如下图：</p><p><img src="'+z+'" alt=""></p></li></ul><ol start="2"><li>更换ets</li></ol><ul><li><p>备份原来的ets文件，把SDK目录下的9/ets改成ets_backup，如下图：</p><p><img src="'+j+'" alt=""></p></li><li><p>解压文件ets-windows-x64-3.2.11.9-Release.zip至OHOS-SDK/9目录：</p></li></ul><p><img src="'+T+'" alt=""></p><ul><li>打开命令行进入目录OHOS_SDK\\9\\ets\\build-tools\\ets-loader，并执行npm install，如下图（注意目录要匹配）：</li></ul><p><img src="'+N+'" alt=""></p><pre><code>&gt; **注意**：如果 `npm install` 报错，检查下是否配置了华为的源，配置方法如下：\n&gt; ` npm config set registry https://repo.huaweicloud.com/repository/npm/ `\n</code></pre><ul><li><p>在 deveco 里，clear project 之后，重新 build 即可。clear project 操作如下图：</p><p><img src="'+L+'" alt=""></p></li></ul><ol><li>其他 js-windows-x64-3.2.11.9-Release.zip previewer-windows-x64-3.2.11.9-Release.zip toolchains-windows-x64-3.2.11.9-Release.zip 这三个文件参考上诉步骤替换，总结步骤入下：</li></ol><ul><li><p>备份SDK目录（OHOS_SDK/9）里的文件；</p></li><li><p>解压至OHOS_SDK/9至对应的文件； <em><strong>（注意‘9’是API版本，未来升级就对应升级之后的API版本）</strong></em> 目录对应关系，如下图：</p><p><img src="'+Y+'" alt=""></p></li></ul><h3 id="cocos-creator-构建-openharmony-工程" tabindex="-1">Cocos Creator 构建 OpenHarmony 工程 <a class="header-anchor" href="#cocos-creator-构建-openharmony-工程" aria-label="Permalink to &quot;Cocos Creator 构建 OpenHarmony 工程&quot;">​</a></h3><ol><li><p>设置 OpenHarmony SDK 的路径，如下图：</p><p><img src="'+G+'" alt=""></p><p>可以使用 DevEco 查看 SDK 的路径。</p></li><li><p>打开 DevEco，点击标题栏里的，File-&gt;Settings...，如下图：</p><p><img src="'+M+'" alt=""></p></li><li><p>查看 OpenHarmony SDK 的配置，如下图：</p><p><img src="'+J+'" alt=""></p><blockquote><p><strong>注意</strong>：API Version 9 的版本要为已安装的状态，如果未安装，需要手动安装，如上图所示。</p></blockquote></li><li><p>打开 Cocos Creator，打开存在的项目，如下图：</p><blockquote><p><img src="'+V+'" alt=""></p></blockquote></li><li><p>选择工程的目录，以下以 <a href="https://github.com/cocos/cocos-test-projects/tree/v3.8" target="_blank" rel="noreferrer">cocos-test-projects</a> 为例，如下图：</p><p><img src="'+Q+'" alt=""></p></li><li><p>登录开发者账号，如下图：</p><p><img src="'+X+'" alt=""></p></li><li><p>根据创建游戏，增加游戏逻辑等</p></li><li><p>制作完成之后，选择构建，选择标题栏中的 Project-&gt;Build，也可以使用 Ctrl+Shift+B 的快捷键，如下图：</p><p><img src="'+Z+'" alt=""></p></li><li><p>点击新建任务，如下图：</p><p><img src="'+W+'" alt=""></p></li><li><p>选择 Openharmony</p><p><img src="'+$+'" alt=""></p></li><li><p>配置工程名称、配置开始场景与包含的其他场景，配置Debug/Release, 配置32位cocos应用或64位cocos应用（对应OpenHarmony32位系统与64位系统），点击 build，如下图：</p><p><img src="'+oo+'" alt=""><img src="'+so+'" alt=""></p></li><li><p>点击 make（目前会提示失败，但是会生成无签名的 hap 包），之后点击 run（需要设备，由于没有签名，目前 run 会失败）即可（由于目前 make 和 run 都会失败，因此可以不操作）。</p><p><img src="'+eo+'" alt=""></p></li></ol><h3 id="烧录-hap-包到-rk-板" tabindex="-1">烧录 Hap 包到 RK 板 <a class="header-anchor" href="#烧录-hap-包到-rk-板" aria-label="Permalink to &quot;烧录 Hap 包到 RK 板&quot;">​</a></h3><ol><li><p>构建工程成功后，如下状态即可，make 与 run 可以不需要点击，如下图：</p><p><img src="'+to+'" alt=""></p></li><li><p>使用<a href="https://developer.harmonyos.com/cn/develop/deveco-studio#download" target="_blank" rel="noreferrer">DevEcoStudio</a>，打开工程，如下图：</p><p><img src="'+co+'" alt=""></p></li><li><p>找到工程目录（native/engine/openharmony）并点击打开，如下图（下图是以<a href="https://github.com/cocos/cocos-test-projects" target="_blank" rel="noreferrer">cocos-test-projects</a>为例）：</p><p><img src="'+ao+'" alt=""></p></li><li><p>配置签名，如下图：</p><p><img src="'+ro+'" alt=""></p></li><li><p>插入设备，点击运行，如下图：</p><p><img src="'+po+'" alt=""></p></li></ol><p>执行成功之后，就能看到效果了。</p><h2 id="几个注意事项" tabindex="-1">几个注意事项 <a class="header-anchor" href="#几个注意事项" aria-label="Permalink to &quot;几个注意事项&quot;">​</a></h2><p>目前 Cocos Creator 支持在 OpenHarmony 32位 与 64位 系统运行，且系统暂不支持 JIT，但是引擎目前支持AOT优化。</p><p>另外，因为 OpenHarmony 还在不断完善当中，因此有些已知问题。这些问题都会在后续的版本解决。</p><ol><li>目前已知问题是： <ul><li>restart 目前还未有方案；</li><li>editbox显示时，会把这个游戏页面往上推</li><li>RK3568不支持陀螺仪，线性加速度</li><li>部分测试例，背景会显示桌面，驱动问题，非系统和引擎问题</li><li>编译失败时，可能是内存不足导致，退出部分应用，重新 build 试试； <blockquote><blockquote><p><img src="'+io+'" alt=""></p></blockquote></blockquote></li><li>App Launch提示错误信息，在targets中，添加对应的运行环境： <blockquote><blockquote><p><img src="'+no+'" alt=""> 解决方法，如下图： <img src="'+lo+'" alt=""></p></blockquote></blockquote></li><li>更新IDE，编译报错,如下图： <blockquote><blockquote><p><img src="'+mo+'" alt=""> 把Harmonyos与openharmony的SDK更新到最新；</p></blockquote></blockquote></li><li><a href="https://github.com/cocos/cocos-engine/pull/15785" target="_blank" rel="noreferrer">同时勾选左横屏与右横屏，会出现分辨率不正确的现象。只选择左横屏或者右横屏即可解决</a>。</li></ul></li></ol>',45),ho=[go];function uo(bo,Io,Do,yo,fo,ko){return t(),e("div",null,ho)}const Ho=s(_o,[["render",uo]]);export{Eo as __pageData,Ho as default};
